# カンバンTodoアプリ PR計画

## 方針

- 1 PR = 1つの論理的変更群（1文で説明できる単位）
- レイヤーごとに分離（shared → backend → frontend）
- 機械的変更（整形・リネーム）と意味のある変更（ロジック・仕様）を分離
- リファクタ（挙動不変）と挙動変更（機能追加）を分離
- 各PRは可能な限りマージ可能・デプロイ可能な状態を維持

## PR一覧

### PR #1: ドキュメント整備（要件・仕様・計画） — Issue #1

**ブランチ名**: `docs/kanban-requirements-<timestamp>`

| #   | コミットメッセージ                         | 変更内容                                                           |
| --- | ------------------------------------------ | ------------------------------------------------------------------ |
| 1   | `docs: カンバンTodoアプリの要件定義を作成` | `docs/01_要件.md`                                                  |
| 2   | `docs: カンバンTodoアプリの仕様を作成`     | `docs/02_仕様.md`                                                  |
| 3   | `docs: カンバンTodoアプリの実装計画を作成` | `docs/03_計画.md`, `docs/03_01_PR計画.md`, `docs/04_タスク一覧.md` |

---

### PR #2: 共有型定義の追加 — Issue #2

**ブランチ名**: `feat/task-shared-types-<timestamp>`

| #   | コミットメッセージ                                     | 変更内容                         |
| --- | ------------------------------------------------------ | -------------------------------- |
| 1   | `feat(shared): Task モデル型と Status 型を追加`        | `shared/src/types/model/task.ts` |
| 2   | `feat(shared): Task API リクエスト/レスポンス型を追加` | `shared/src/types/api/task.ts`   |
| 3   | `feat(shared): Task 関連型の re-export を追加`         | `shared/src/index.ts`            |

---

### PR #3: バックエンド D1 セットアップ・テスト基盤・Bindings型定義 — Issue #3

**ブランチ名**: `feat/d1-setup-<timestamp>`

> ローカル開発限定。リモートD1作成・`database_id`設定はスコープ外。

| #   | コミットメッセージ                                                                    | 変更内容                                            |
| --- | ------------------------------------------------------------------------------------- | --------------------------------------------------- |
| 1   | `feat(db): tasks テーブルのマイグレーション SQL を作成`                               | `backend/db/migrations/0001_create_tasks_table.sql` |
| 2   | `chore(backend): wrangler.jsonc に D1 バインディングを追加`                           | `backend/wrangler.jsonc`                            |
| 3   | `feat(backend): Hono Bindings 型を定義、グローバルエラーハンドラ追加`                 | `backend/src/index.ts`                              |
| 4   | `chore(backend): @cloudflare/vitest-pool-workers を導入、vitest.config.ts を書き換え` | `backend/package.json`, `backend/vitest.config.ts`  |

---

### PR #4: バックエンド Task CRUD ユースケースの実装 — Issue #4

**ブランチ名**: `feat/task-usecases-<timestamp>`

| #   | コミットメッセージ                                        | 変更内容                                                                |
| --- | --------------------------------------------------------- | ----------------------------------------------------------------------- |
| 1   | `feat(backend): TaskRow 型と toTask マッピング関数を追加` | `backend/src/usecases/task/_tasks.ts`                                   |
| 2   | `feat(backend): タスク一覧取得ユースケースを実装`         | `backend/src/usecases/task/get_usecase.ts`, `get_usecase.test.ts`       |
| 3   | `feat(backend): タスク詳細取得ユースケースを実装`         | `backend/src/usecases/task/detail_usecase.ts`, `detail_usecase.test.ts` |
| 4   | `feat(backend): タスク作成ユースケースを実装`             | `backend/src/usecases/task/create_usecase.ts`, `create_usecase.test.ts` |
| 5   | `feat(backend): タスク更新ユースケースを実装`             | `backend/src/usecases/task/update_usecase.ts`, `update_usecase.test.ts` |
| 6   | `feat(backend): タスク削除ユースケースを実装`             | `backend/src/usecases/task/delete_usecase.ts`, `delete_usecase.test.ts` |
| 7   | `feat(backend): タスク移動ユースケースを実装`             | `backend/src/usecases/task/move_usecase.ts`, `move_usecase.test.ts`     |

---

### PR #5: バックエンド Task コントローラーの実装 — Issue #5

**ブランチ名**: `feat/task-controller-<timestamp>`

| #   | コミットメッセージ                                      | 変更内容                                          |
| --- | ------------------------------------------------------- | ------------------------------------------------- |
| 1   | `feat(backend): タスクコントローラーを実装`             | `backend/src/controllers/task_controller.ts`      |
| 2   | `feat(backend): タスクルートをアプリに追加`             | `backend/src/index.ts`                            |
| 3   | `test(backend): タスクコントローラーの統合テストを追加` | `backend/src/controllers/task_controller.test.ts` |

---

### PR #6: フロントエンド タスクサービスフックの実装 — Issue #6

**ブランチ名**: `feat/task-service-hooks-<timestamp>`

| #   | コミットメッセージ                                             | 変更内容                                              |
| --- | -------------------------------------------------------------- | ----------------------------------------------------- |
| 1   | `feat(frontend): タスク用 API パス定数を追加`                  | `frontend/src/pages/kanban/services/constants.ts`     |
| 2   | `feat(frontend): タスク一覧取得フックを実装`                   | `frontend/src/pages/kanban/services/useTasks.ts`      |
| 3   | `feat(frontend): タスク作成フックを実装`                       | `frontend/src/pages/kanban/services/useCreateTask.ts` |
| 4   | `feat(frontend): タスク更新フックを実装`                       | `frontend/src/pages/kanban/services/useUpdateTask.ts` |
| 5   | `feat(frontend): タスク削除フックを実装`                       | `frontend/src/pages/kanban/services/useDeleteTask.ts` |
| 6   | `feat(frontend): タスク移動フックを楽観的更新で実装`           | `frontend/src/pages/kanban/services/useMoveTask.ts`   |
| 7   | `test(frontend): MSW ハンドラーとサービスフックのテストを追加` | MSW ハンドラー、各テストファイル                      |

---

### PR #7: フロントエンド カンバンボード UI コンポーネントの実装 — Issue #7

**ブランチ名**: `feat/kanban-ui-components-<timestamp>`

| #   | コミットメッセージ                                     | 変更内容                                       |
| --- | ------------------------------------------------------ | ---------------------------------------------- |
| 1   | `chore(frontend): @dnd-kit 関連パッケージを追加`       | `frontend/package.json`                        |
| 2   | `feat(frontend): TaskCard コンポーネントを実装`        | `TaskCard.tsx`, `TaskCard.stories.tsx`         |
| 3   | `feat(frontend): KanbanColumn コンポーネントを実装`    | `KanbanColumn.tsx`, `KanbanColumn.stories.tsx` |
| 4   | `feat(frontend): TaskCreateModal コンポーネントを実装` | `TaskCreateModal.tsx`                          |
| 5   | `feat(frontend): TaskEditModal コンポーネントを実装`   | `TaskEditModal.tsx`                            |
| 6   | `feat(frontend): KanbanBoardPage を実装`               | `KanbanBoardPage.tsx`                          |

---

### PR #8: フロントエンド ルーティング統合・テスト — Issue #8

**ブランチ名**: `feat/kanban-integration-<timestamp>`

| #   | コミットメッセージ                                   | 変更内容                              |
| --- | ---------------------------------------------------- | ------------------------------------- |
| 1   | `feat(frontend): トップページをカンバンボードに変更` | `frontend/src/routes/index/route.tsx` |
| 2   | `test(frontend): カンバンボードの統合テストを追加`   | 統合テストファイル                    |
| 3   | `test(frontend): DnD 操作の統合テストを追加`         | DnD テストファイル                    |

---

### PR #9: ドキュメント・設定の更新 — Issue #9

**ブランチ名**: `docs/update-readme-<timestamp>`

| #   | コミットメッセージ                                    | 変更内容                          |
| --- | ----------------------------------------------------- | --------------------------------- |
| 1   | `docs: README を更新`                                 | `README.md`                       |
| 2   | `docs: copilot-instructions のプロジェクト内容を更新` | `.github/copilot-instructions.md` |

## PR 依存関係

```
PR #1 (ドキュメント)
  └─ 独立（いつでもマージ可能）

PR #2 (共有型定義)
  ├─ PR #3 (D1セットアップ・テスト基盤)
  │    └─ PR #4 (ユースケース)
  │         └─ PR #5 (コントローラー)
  └─ PR #6 (サービスフック)
       └─ PR #7 (UIコンポーネント)
            └─ PR #8 (統合)

PR #9 (ドキュメント更新)
  └─ 最後にマージ
```

> **並列開発**: PR #2 マージ後、バックエンドチェーン（PR #3→#4→#5）とフロントエンドチェーン（PR #6→#7→#8）は並列で開発可能。

## マージ順序

1. PR #1 → PR #2 → PR #3 → PR #4 → PR #5
2. PR #6 → PR #7 → PR #8
3. PR #9
